<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- PWA –ú–ï–¢–ê-–¢–ï–ì–ò -->
    <meta name="theme-color" content="#0c2461">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAA1BMVEX///+nxBvIAAAASElEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GxXgAAGhawT4AAAAAElFTkSuQmCC">
    
    <title>–ö–Ω–æ–ø–æ—á–∫–∞ –ë–æ–≥–¥–∞–Ω–∞ | PWA</title>
    
    <style>
        /* –°–ë–†–û–° –ò –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0c2461, #1e3799);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –û PWA */
        .pwa-install {
            background: linear-gradient(90deg, #f6b93b, #e55039);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
            animation: slideDown 0.5s;
            position: relative;
            width: 100%;
            max-width: 400px;
        }

        .pwa-install button {
            background: white;
            color: #0c2461;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-weight: bold;
            cursor: pointer;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† */
        .container {
            max-width: 500px;
            width: 100%;
            text-align: center;
        }

        /* –®–ê–ü–ö–ê */
        header {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            border: 2px solid #f6b93b;
        }

        h1 {
            font-size: 2rem;
            color: #f6b93b;
            margin-bottom: 5px;
        }

        .subtitle {
            color: #82ccdd;
            font-size: 0.9rem;
        }

        /* –ò–ù–°–¢–ê–õ–õ –ü–û–î–°–ö–ê–ó–ö–ê */
        .install-hint {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 0.8rem;
            color: #82ccdd;
            border: 1px dashed #f6b93b;
        }

        /* –ö–ù–û–ü–ö–ê –ë–û–ì–î–ê–ù–ê */
        .bogdan-btn {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, #e55039, #b71540);
            border: none;
            color: white;
            font-size: 1.8rem;
            font-weight: bold;
            margin: 20px auto;
            display: block;
            box-shadow: 0 0 40px #e55039;
            cursor: pointer;
            transition: transform 0.1s;
            touch-action: manipulation;
        }

        .bogdan-btn:active {
            transform: scale(0.95);
        }

        /* –°–ß–Å–¢ */
        #score {
            font-size: 3rem;
            color: #f6b93b;
            font-family: monospace;
            margin: 10px 0;
        }

        /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .stat-box {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .stat-value {
            font-size: 1.5rem;
            color: #f6b93b;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #82ccdd;
        }

        /* –ö–ù–û–ü–ö–ê –ò–ù–°–¢–ê–õ–õ–ê */
        .install-btn {
            background: linear-gradient(90deg, #78e08f, #38ada9);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: bold;
            margin: 20px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        /* –§–£–¢–ï–† */
        footer {
            margin-top: 30px;
            color: #636e72;
            font-size: 0.8rem;
            text-align: center;
        }

        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 400px) {
            .bogdan-btn {
                width: 180px;
                height: 180px;
                font-size: 1.6rem;
            }
            #score { font-size: 2.5rem; }
            h1 { font-size: 1.8rem; }
        }

        /* –¢–Å–ú–ù–ê–Ø –¢–ï–ú–ê */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #0a0a0a, #1a1a1a);
            }
        }
    </style>
</head>
<body>
    <!-- –£–í–ï–î–û–ú–õ–ï–ù–ò–ï –û–ë –ò–ù–°–¢–ê–õ–õ–ï -->
    <div class="pwa-install" id="pwaInstallPrompt">
        <p>üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–≥—Ä—É –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω!</p>
        <p style="font-size: 0.8rem;">–†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω, –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>
        <button onclick="installPWA()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        <button onclick="hidePrompt()" style="background: transparent; color: white; margin-left: 10px;">–ü–æ–∑–∂–µ</button>
    </div>

    <div class="container">
        <header>
            <h1>üéÆ –ö–ù–û–ü–û–ß–ö–ê –ë–û–ì–î–ê–ù–ê</h1>
            <p class="subtitle">PWA –≤–µ—Ä—Å–∏—è | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!</p>
            
            <div class="install-hint">
                üí° –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏: –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"
            </div>
        </header>

        <div id="score">0</div>
        <p style="color: #82ccdd;">–°–∏–ª–∞ –ë–æ–≥–¥–∞–Ω–∞</p>

        <button class="bogdan-btn" id="bogdanBtn">–¢–ê–ü–ê–¢–¨</button>

        <div class="stats">
            <div class="stat-box">
                <div id="cps" class="stat-value">0</div>
                <div class="stat-label">–¢–∞–ø–æ–≤/—Å–µ–∫</div>
            </div>
            <div class="stat-box">
                <div id="multiplier" class="stat-value">x1.0</div>
                <div class="stat-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å</div>
            </div>
            <div class="stat-box">
                <div id="autoclick" class="stat-value">0/—Å–µ–∫</div>
                <div class="stat-label">–ê–≤—Ç–æ-—Ç–∞–ø</div>
            </div>
            <div class="stat-box">
                <div id="crystals" class="stat-value">0</div>
                <div class="stat-label">üíé –ö—Ä–∏—Å—Ç–∞–ª–ª—ã</div>
            </div>
        </div>

        <button class="install-btn" onclick="showInstallInstructions()">
            üì≤ –ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å?
        </button>

        <footer>
            <p>üîã –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω | üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>
            <p style="margin-top: 10px; color: #f6b93b;" id="pwaStatus">–ü—Ä–æ–≤–µ—Ä–∫–∞ PWA...</p>
        </footer>
    </div>

    <script>
        // ========== PWA –§–£–ù–ö–¶–ò–ò ==========
        let deferredPrompt;
        let isPWAInstalled = false;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ª–∏ PWA
        function checkPWA() {
            if (window.matchMedia('(display-mode: standalone)').matches ||
                window.navigator.standalone ||
                document.referrer.includes('android-app://')) {
                isPWAInstalled = true;
                document.getElementById('pwaStatus').textContent = '‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ';
                document.getElementById('pwaInstallPrompt').style.display = 'none';
            } else {
                document.getElementById('pwaStatus').textContent = 'üì± –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏';
            }
        }

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ beforeinstallprompt
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                if (!isPWAInstalled) {
                    document.getElementById('pwaInstallPrompt').style.display = 'block';
                }
            }, 3000);
        });

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PWA
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('PWA —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                        document.getElementById('pwaInstallPrompt').style.display = 'none';
                        isPWAInstalled = true;
                    }
                    deferredPrompt = null;
                });
            } else {
                showInstallInstructions();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
        function showInstallInstructions() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isAndroid = /Android/.test(navigator.userAgent);
            
            let message = '';
            
            if (isIOS) {
                message = 'üì± –ù–∞ iPhone/iPad:\n1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" (üì§)\n2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑\n3. –ù–∞–∂–º–∏—Ç–µ "–ù–∞ —ç–∫—Ä–∞–Ω ¬´–î–æ–º–æ–π¬ª"\n4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É';
            } else if (isAndroid) {
                message = 'üì± –ù–∞ Android:\n1. –ù–∞–∂–º–∏—Ç–µ –º–µ–Ω—é (—Ç—Ä–∏ —Ç–æ—á–∫–∏)\n2. –í—ã–±–µ—Ä–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"\n3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É';
            } else {
                message = 'üíª –ù–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:\n1. –ù–∞–∂–º–∏—Ç–µ –º–µ–Ω—é –±—Ä–∞—É–∑–µ—Ä–∞\n2. –í—ã–±–µ—Ä–∏—Ç–µ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"\n3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É';
            }
            
            alert(message);
        }

        function hidePrompt() {
            document.getElementById('pwaInstallPrompt').style.display = 'none';
        }

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É
        window.addEventListener('appinstalled', () => {
            isPWAInstalled = true;
            document.getElementById('pwaInstallPrompt').style.display = 'none';
            document.getElementById('pwaStatus').textContent = '‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ';
        });

        // ========== –ò–ì–†–û–í–ê–Ø –õ–û–ì–ò–ö–ê ==========
        let game = {
            score: 0,
            crystals: 0,
            multiplier: 1.0,
            autoLevel: 1,
            clicks: 0,
            lastTime: Date.now(),
            autoInterval: null
        };

        function initGame() {
            loadGame();
            updateDisplay();
            
            // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
            clearInterval(game.autoInterval);
            game.autoInterval = setInterval(() => {
                game.score += game.autoLevel * game.multiplier;
                updateDisplay();
                saveGame();
            }, 1000);
            
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            setInterval(saveGame, 10000);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º PWA
            checkPWA();
            
            console.log('üéÆ –ò–≥—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞ –∫–∞–∫ PWA');
        }

        function clickBogdan() {
            game.score += 1 * game.multiplier;
            game.clicks++;
            
            // –®–∞–Ω—Å –ø–æ–ª—É—á–∏—Ç—å –∫—Ä–∏—Å—Ç–∞–ª–ª
            if (Math.random() < 0.02) {
                game.crystals++;
            }
            
            updateDisplay();
            saveGame();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            const btn = document.getElementById('bogdanBtn');
            btn.style.transform = 'scale(0.95)';
            setTimeout(() => btn.style.transform = 'scale(1)', 100);
            
            // –í–∏–±—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        function updateDisplay() {
            // –°—á—ë—Ç
            document.getElementById('score').textContent = Math.floor(game.score).toLocaleString();
            document.getElementById('crystals').textContent = game.crystals;
            document.getElementById('multiplier').textContent = 'x' + game.multiplier.toFixed(1);
            
            // CPS
            const now = Date.now();
            if (now - game.lastTime >= 1000) {
                document.getElementById('cps').textContent = game.clicks;
                game.clicks = 0;
                game.lastTime = now;
            }
            
            // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
            document.getElementById('autoclick').textContent = game.autoLevel + '/—Å–µ–∫';
        }

        // ========== –°–û–•–†–ê–ù–ï–ù–ò–ï ==========
        function saveGame() {
            localStorage.setItem('bogdanPWA', JSON.stringify(game));
        }

        function loadGame() {
            const saved = localStorage.getItem('bogdanPWA');
            if (saved) {
                game = JSON.parse(saved);
                game.lastTime = Date.now();
                game.clicks = 0;
            }
        }

        // ========== –°–û–ë–´–¢–ò–Ø ==========
        document.getElementById('bogdanBtn').addEventListener('click', clickBogdan);
        document.getElementById('bogdanBtn').addEventListener('touchstart', function(e) {
            e.preventDefault();
            clickBogdan();
        }, { passive: false });

        // –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏–π
        let pressTimer;
        document.getElementById('bogdanBtn').addEventListener('touchstart', function(e) {
            pressTimer = setTimeout(() => {
                // –£–ª—É—á—à–µ–Ω–∏–µ –∑–∞ –∫—Ä–∏—Å—Ç–∞–ª–ª—ã
                if (game.crystals >= 10) {
                    game.crystals -= 10;
                    game.multiplier += 0.5;
                    alert('‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ! –ú–Ω–æ–∂–∏—Ç–µ–ª—å: x' + game.multiplier.toFixed(1));
                    updateDisplay();
                    saveGame();
                }
            }, 1000);
        });

        document.getElementById('bogdanBtn').addEventListener('touchend', function() {
            clearTimeout(pressTimer);
        });

        // ========== –û–§–§–õ–ê–ô–ù –†–ê–ë–û–¢–ê ==========
        // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // –°–æ–∑–¥–∞—ë–º inline Service Worker
                const swCode = `
                    self.addEventListener('install', event => {
                        console.log('üéÆ Service Worker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
                        self.skipWaiting();
                    });

                    self.addEventListener('activate', event => {
                        console.log('üéÆ Service Worker –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
                    });

                    self.addEventListener('fetch', event => {
                        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã - –∏–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω
                        console.log('üéÆ –ó–∞–ø—Ä–æ—Å –∏–∑ –∫—ç—à–∞:', event.request.url);
                    });
                `;

                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swURL = URL.createObjectURL(blob);

                navigator.serviceWorker.register(swURL)
                    .then(registration => {
                        console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
                    })
                    .catch(error => {
                        console.log('‚ùå –û—à–∏–±–∫–∞ Service Worker:', error);
                    });
            });
        }

        // ========== –ó–ê–ü–£–°–ö ==========
        window.addEventListener('load', initGame);
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
        document.addEventListener('contextmenu', e => e.preventDefault());
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
        document.addEventListener('touchmove', function(e) {
            if(e.scale !== 1) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>